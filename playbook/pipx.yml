---
- hosts: all
  tasks:
    - name: Ensure pipx is installed
      become: yes
      apt:
        pkg: pipx
    - name: Ensure pipx is in $PATH
      blockinfile:
        path: "{{ ansible_env.HOME }}/.bashrc"
        block: |
          # For pipx (https://github.com/pipxproject/pipx)
          export PATH="{{ ansible_env.HOME }}/.local/bin:$PATH"
    - name: Ensure sphinx is installed via pipx
      shell: |
        pipx install sphinx
        pipx inject sphinx sphinxcontrib-needs

